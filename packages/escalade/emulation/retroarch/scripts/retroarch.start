#!/bin/sh

. /etc/profile

kodifreeze.sh freeze

if [ ! -z "REFRESH" ]; then
  test -x /usr/bin/tvservice && tvservice -e "CEA 31" || xrandr -r 50
fi

kms_on

# Launch RetroArch
/usr/bin/retroarch -v "$@" > /var/log/retroarch.log 2>&1

kms_off

if [ ! -z "REFRESH" ]; then
  test -x /usr/bin/tvservice && tvservice -e "CEA 16" || xrandr -r 60
fi

pidof emulationstation > /dev/null 2>&1 || kodifreeze.sh unfreeze
